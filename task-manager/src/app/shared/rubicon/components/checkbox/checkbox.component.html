<div [formGroup]="group">
  <ng-container *ngIf="!field.options || field.options.length == 0">
    <div class="form-check">
      <input type="checkbox" class="form-check-input" [id]="field?.key" [formControlName]="field?.key"
        [ngClass]="{'is-invalid':isInvalid()}" />
      <label class="form-check-label" [for]="field?.key">
        {{getLabel()}}
      </label>
    </div>

    <div class="invalid-feedback d-block" *ngIf="isInvalid()">
      <ng-container *ngFor="let err of getErrors()">
        <div>{{ err }}</div>
      </ng-container>
    </div>
  </ng-container>
  <ng-container *ngIf="field?.options && field?.options?.length > 0">
    <label class="form-check-label" [for]="field?.key">
        {{getLabel()}}
      </label>
    <div [formArrayName]="field?.key">
      <div class="form-check" *ngFor="let opt of field.options; let i = index" [formGroupName]="i">
        <input type="checkbox" class="form-check-input" [id]="field.key+'_'+i" formControlName="selected"
          (change)="onCheckboxChange(i)" />
        <label class="form-check-label" [for]="field.key + '_' + i">
          {{ opt.label }}
        </label>
      </div>
    </div>
    <div class="invalid-feedback d-block" *ngIf="isInvalidArray()">
      <ng-container *ngFor="let err of getErrors()">
        <div>{{ err }}</div>
      </ng-container>
    </div>
  </ng-container>
</div>